# Архитектура ядра и модулей

## Обзор

Архитектура состоит из ядра (`Core`) и подключаемых модулей (`Modules`). Ядро предоставляет базовую функциональность, а модули расширяют и/или переопределяют эту функциональность.

## Основные концепции

### Ядро (Core)

Ядро включает в себя:
- Базовые компоненты и сервисы
- Систему авторизации и аутентификации
- Систему маршрутизации
- Управление состоянием
- API для расширения функциональности модулями

### Модули (Modules)

Модули могут:
- Добавлять новые компоненты и функциональность
- Переопределять элементы ядра (например, логотип, тему)
- Регистрировать новые маршруты
- Добавлять свои хранилища для управления состоянием

## Структура проекта

```
src/
├── core/               # Ядро приложения
│   ├── api/            # API клиенты и интерфейсы
│   ├── components/     # Базовые компоненты
│   ├── config/         # Конфигурации
│   ├── plugins/        # Плагины Vue
│   ├── services/       # Сервисы
│   ├── store/          # Хранилища (Pinia)
│   ├── utils/          # Утилиты
│   ├── bootstrap.ts    # Инициализация ядра и модулей
│   └── index.ts        # Главный экспорт ядра
│
├── modules/            # Подключаемые модули
│   ├── module1/        # Пример модуля
│   │   ├── components/ # Компоненты модуля
│   │   ├── routes.ts   # Маршруты модуля
│   │   └── index.ts    # Главный файл модуля
│   └── ...
│
└── main.ts             # Точка входа приложения
```

## Использование ядра и модулей

### Инициализация

```typescript
import { bootstrap } from '@/core/bootstrap';
import App from './App.vue';

bootstrap({
  rootComponent: App,
  rootElement: '#app',
  modules: [
    'module1', // Динамическая загрузка по имени
    customModule, // Прямой импорт модуля
  ],
  useCoreLicense: true,
})
.then(({ app, router, pinia }) => {
  console.log('Приложение инициализировано!');
});
```

### Создание модуля

```typescript
import { createModule } from '@/core/utils/module-utils';

const myModule = createModule({
  name: 'my-module',
  
  // Маршруты модуля
  routes: [...],
  
  // Компоненты модуля
  components: {
    MyComponent: () => import('./components/MyComponent.vue'),
  },
  
  // Метод расширения ядра
  extend: (core) => {
    // Переопределение настроек ядра
    core.extendConfig({
      theme: {
        primary: '#FF0000',
      },
    });
  },
  
  // Настройка модуля
  setup: (app, router, pinia) => {
    // Инициализация модуля
  },
});

export default myModule;
```

## Расширение функциональности ядра

### Переопределение компонентов

```typescript
// В модуле
extend: (core) => {
  // Регистрация своего компонента вместо стандартного
  core.overrideComponent('Logo', CustomLogo);
}
```

### Изменение темы

```typescript
// В модуле
extend: (core) => {
  core.extendConfig({
    theme: {
      primary: '#FF0000',
      secondary: '#00FF00',
    },
  });
}
```

## Авторизация и безопасность

Ядро предоставляет систему авторизации, которую модули могут использовать:

```typescript
// Использование авторизации
const isAuthenticated = core.auth.isAuthenticated();
const currentUser = core.auth.getUser();

// Логин
core.auth.login(credentials)
  .then(user => {
    // Успешная авторизация
  });

// Логаут
core.auth.logout()
  .then(() => {
    // Успешный выход
  });
```

## Лицензирование

Ядро включает систему проверки лицензии. Для использования ядра в коммерческих проектах необходимо приобрести лицензию.

## Распространение и установка

### Для разработчиков ядра

1. Разработка ядра и базовых модулей
2. Сборка и подготовка пакета
3. Публикация в NPM или собственном репозитории

### Для клиентов

1. Установка ядра: `npm install your-core-package`
2. Создание своего проекта с использованием ядра
3. Разработка собственных модулей для расширения функциональности 